<?xml version="1.0" encoding="utf-8"?>

<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <Target Name="DeepCleanProjectAfterBuild"
          AfterTargets="Build">
    <Message Text="Deep cleaning project $(AssemblyName)..." />

    <CreateItem Include="$(ProjectDir)\obj\**\*.*">
      <Output TaskParameter="Include"
              ItemName="AfterClean_FilesToDelete"/>
    </CreateItem>
    <Delete Files="@(AfterClean_FilesToDelete)" />

    <CreateItem Include="$(ProjectDir)\obj" >
      <Output TaskParameter="Include"
              ItemName="AfterClean_DirectoriesToDelete" />
    </CreateItem>
    <RemoveDir ContinueOnError="true"
               Directories="@(AfterClean_DirectoriesToDelete)" />
  </Target>

  <Target Name="DeepCleanProjectAfterClean"
          AfterTargets="Clean">
    <Message Text="Deep cleaning project $(AssemblyName)..." />

    <CreateItem Include="$(OutDir)\*.*; $(ProjectDir)\obj\**\*.*"
                Exclude="$(OutDir)\*.vshost.exe.*">
      <Output TaskParameter="Include"
              ItemName="AfterClean_FilesToDelete"/>
    </CreateItem>
    <Delete Files="@(AfterClean_FilesToDelete)" />

    <CreateItem Include="$(ProjectDir)\obj" >
      <Output TaskParameter="Include"
              ItemName="AfterClean_DirectoriesToDelete" />
    </CreateItem>
    <RemoveDir ContinueOnError="true"
               Directories="@(AfterClean_DirectoriesToDelete)" />
  </Target>
</Project>
